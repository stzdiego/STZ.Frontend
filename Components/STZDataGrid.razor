@typeparam TItem
@typeparam TId
@using MudBlazor
@using STZ.Frontend.Services
@inject LocalizationService Localization

@if (ShowToolbarTitle)
{
    <MudPaper Class="py-1 px-2 mt-2">
        <MudStack Row AlignItems="AlignItems.Center">
            <MudText Typo="Typo.h6"><STZText Key="@Title" /></MudText>
            <MudSpacer />
            @if (AddComponentType is not null)
            {
                <MudIconButton Icon="@Icons.Material.Filled.Add" Size="Size.Medium" OnClick="@(() => ShowAddDialog())" />
            }
        </MudStack>
    </MudPaper>
}


<MudDataGrid @ref="_dataGrid"
             T="TItem"
             Class="mt-3"
             ServerData="ServerDataFunc"
             Hover="true"
             Filterable="true"
             FixedHeader="true"
             ShowMenuIcon="true"
             SelectedItem="@SelectedItem">
    <ToolBarContent>
        @if (ShowSearch)
        {
            <MudTextField T="string"
                          Placeholder="Buscar"
                          Adornment="Adornment.Start"
                          AdornmentIcon="@Icons.Material.Filled.Search"
                          IconSize="Size.Medium"
                          FullWidth="false"
                          ValueChanged="@(s => OnSearch(s))" />
        }
        <MudSpacer/>
    </ToolBarContent>

    <Columns>
        @if (ShowActions)
        {
            <TemplateColumn Title="@Localization.Get("Grid.Actions")">
                <CellTemplate Context="context">
                    @if (DetailComponentType is not null)
                    {
                        <MudIconButton Size="Size.Small" Icon="@Icons.Material.Outlined.Visibility" OnClick="@(() => ShowDetailDialog(context.Item))"/>
                    }
                    @if (EditComponentType is not null)
                    {
                        <MudIconButton Size="Size.Small" Icon="@Icons.Material.Outlined.Edit" OnClick="@(() => ShowEditDialog(context.Item))"/>
                    }
                    @if (ShowDeleteAction)
                    {
                        <MudIconButton Size="Size.Small" Icon="@Icons.Material.Outlined.Delete" OnClick="@(() => OnDelete(context))"/>
                    }
                </CellTemplate>
            </TemplateColumn>
        }

        @if (Columns != null)
        {
            @Columns
        }
    </Columns>

    <PagerContent>
        <MudDataGridPager T="TItem" />
    </PagerContent>
</MudDataGrid>